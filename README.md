# SkyMission Builder (gpkg-to-kmz-for-dji)

## 개요
이 도구는 GPKG 폴리곤 데이터를 DJI 드론용 KML/WPML 기반 KMZ 임무 파일로 대량 변환하는 전문 솔루션입니다. 복잡한 지오메트리 단순화 및 기체별 맞춤형 파라미터 설정을 원클릭으로 처리하여 현장 미션 생성 시간을 획기적으로 단축합니다.

## 핵심 기능
- **대량 자동 변환**: 수백 개의 폴리곤이 포함된 GPKG 파일을 개별 미션 KMZ로 자동 분할 및 명명.
- **향상된 UI/UX**: 좌측 사이드바와 우측 탭 구조의 직관적인 인터페이스 제공. (스크롤 지원, 반응형 레이아웃)
- **강력한 지도 미리보기**: 
  - 구글 위성 하이브리드(Satellite) 기본 지원 및 뷰 전환 기능.
  - KMZ 파일 직접 미리보기 지원.
  - 미션 영역(폴리곤) 시인성 최적화(밝은 테두리 강조).
- **물리적 버퍼(Buffer)**: 미션 지오메트리를 물리적 거리(m) 단위로 확장(+)하거나 축소(-)하는 기능 추가.
- **기체 최적화**: Mavic 3E, M350, Matrice 30 등 다양한 DJI 기체별 파라미터 자동 적용.
- **지오메트리 단순화**: 점 개수를 줄여 드론 부하를 방지하는 Simplify 기능.
- **정밀 미션 제어**: 고도, 중첩도, 짐벌 피치, 자동 비행 속도 등 상세 설정 가능.
- **프리셋 시스템**: 현장별 최적 설정값을 JSON 파일로 저장/로드하여 반복 작업 최소화.

## 프로젝트 구조
- `src/core/`: 핵심 변환 및 검사 로직 (Generator, Inspector, Enums)
- `src/gui/`: SkyMission Builder 데스크톱 인터페이스 (App.py)
- `src/templates/`: DJI WPML 표준 KML/WPML 템플릿
- `presets/`: 사용자 정의 미션 프리셋 (JSON)
- `input/`: 처리할 소스 (.gpkg, .kml)
- `output/`: 생성된 결과물 (.kmz)
- `docs/`: 프로젝트 고도화 로드맵 및 매뉴얼

### 🛠️ 상세 사용 가이드
프로그램의 구체적인 설정 항목과 단계별 작업 방법은 [**상세 매뉴얼(User Manual)**](./docs/user_manual.md)에서 확인하실 수 있습니다.

## 설치 및 실행 방법

### 1단계: 필수 라이브러리 설치
```bash
pip install shapely geopandas fiona pyproj pyogrio tkintermapview
```

### 2단계: 어플리케이션 실행
프로젝트 루트 폴더에서 다음을 실행합니다.
```bash
python main.py
```

## 사용 팁 (Workflow)
1. `input/` 폴더에 GPKG 파일을 넣습니다.
2. `python main.py`를 실행하여 UI를 엽니다.
3. 좌측 사이드바에서 드론 모델, 고도 등 핵심 설정을 확인합니다.
4. **상세 설정 탭**에서 마진, 중첩도, 물리적 버퍼 등을 미세 조정합니다.
5. 우측 지도 미리보기에서 미션 범위를 확인합니다. (위성 뷰/지도 뷰 전환 가능)
6. '미션 생성 실행' 버튼을 누르면 `output/` 폴더에 KMZ 파일들이 생성됩니다.

## 검증 및 유지보수
생성된 KMZ 파일의 내부 값을 검증하려면 다음 명령을 사용하세요.
```bash
python src/core/inspector.py [KMZ경로]
```

## 참고
- 본 도구는 DJI WPML 1.0.6 표준을 준수합니다.
- 한글 파일명 및 속성값을 완벽하게 지원합니다.